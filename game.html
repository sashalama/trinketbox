<!DOCTYPE html>
<html>
<head>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Quicksand:wght@300&family=Courier+Prime:wght@700&display=swap" rel="stylesheet">
  <style>
    body, html {
      margin: 0; padding: 0; height: 100%;
      background-color: #000;
      background-size: cover; background-position: center;
      font-family: 'Quicksand', sans-serif; color: #fdf5e6;
      display: flex; flex-direction: column; justify-content: flex-end; 
      transition: background 1s ease-in-out; 
    }

    .exit-link {
      position: fixed; top: 20px; left: 20px;
      color: rgba(255, 255, 255, 0.4); font-size: 0.7rem;
      text-decoration: none; font-family: 'Cinzel';
      cursor: pointer; z-index: 100; border: 1px solid rgba(255,255,255,0.2);
      padding: 5px 10px; border-radius: 4px; transition: 0.3s;
    }
    .exit-link:hover { color: #d4af37; border-color: #d4af37; background: rgba(0,0,0,0.5); }

    .mute-btn {
      position: fixed; top: 20px; right: 20px;
      background: rgba(0, 0, 0, 0.4); border: 1px solid #d4af37;
      color: #d4af37; padding: 10px; cursor: pointer; z-index: 10000;
      border-radius: 50%; width: 40px; height: 40px;
      display: flex; justify-content: center; align-items: center;
    }

    .game-container {
      width: 100%; background: rgba(0,0,0,0.85); 
      backdrop-filter: blur(12px); border-top: 2px solid #d4af37;
      padding: 35px; box-sizing: border-box; text-align: center;
      min-height: 40%; animation: fadeIn 1s;
    }

    #story-text { 
      font-family: 'Courier Prime', monospace; font-size: 1.1rem; 
      max-width: 900px; margin: 0 auto 20px auto; line-height: 1.6;
    }

    #choices {
      display: flex; flex-wrap: wrap; justify-content: center;
      gap: 15px; max-width: 800px; margin: 0 auto;
    }

    .choice-btn {
      flex: 1; min-width: 250px; background: rgba(212, 175, 55, 0.1);
      border: 1px solid #d4af37; color: #fdf5e6; padding: 12px;
      cursor: pointer; font-family: 'Cinzel'; border-radius: 5px; transition: 0.3s;
    }
    .choice-btn:hover { background: #d4af37; color: #000; box-shadow: 0 0 10px #d4af37; }

    #player-input {
      width: 60%; max-width: 400px; padding: 12px; background: rgba(255,255,255,0.1);
      border: 1px solid #d4af37; color: white; border-radius: 5px;
      margin-bottom: 20px; text-align: center; font-family: 'Courier Prime';
    }

    .hidden { display: none !important; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  </style>
</head>
<body id="game-body">

<button id="mute-btn" class="mute-btn" onclick="toggleMute()">ðŸ”Š</button>
<audio id="myAudio" loop autoplay><source src="fairymusic.mp3" type="audio/mpeg"></audio>

<a class="exit-link" onclick="location.href='index.html'">[ Return to Sanctuary ]</a>

<div class="game-container">
  <div id="story-text">Loading reality...</div>
  
  <div id="input-area" class="hidden">
    <input type="text" id="player-input" placeholder="Type here..." autocomplete="off">
  </div>

  <div id="choices"></div>
</div>

<script>
  let secretWord = "";

  const scenes = {
    password_check: {
      text: "Before the fragment opens, you must choose a secret word. Choose wisely...",
      input: true,
      buttonText: "Seal the Word",
      onAction: () => {
        const input = document.getElementById('player-input').value;
        if(input.length < 1) return alert("You need a word!");
        secretWord = input;
        renderScene('password_warning');
      }
    },
    password_warning: {
      text: () => `"${secretWord}"... interesting choice. You better remember that. There are no resets in this dimension.`,
      choices: [{ text: "I understand. Open the gate.", next: "pea_field" }]
    },
    pea_field: {
      text: "As the gate opens a blinding light seeps out. You squint and walk in, and once your eyes adjust, you behold, the citadel of peas. Walking across the outskirts you notice a quiet trellis salespea with a faraway look, and next to his stand a glowing peapod.",
      background: "https://i.pinimg.com/1200x/fd/e8/9b/fde89b5dee8a1005afbe1b65923d27ae.jpg",
      choices: [
        { text: "Talk to the salespearson", next: "giant_pea" },
        { text: "I've always wanted to be a pea in a pod, wonder what it means!", next: "pod_search" }
      ]
    },
    giant_pea: {
      text: "The salespea rotates slowly, ignoring his wares. 'I once loved an Italian plant... Mentha peperita,' it whispers. 'She overwatered herself from crying and died after her favorite book protagonist died without fulfilling the slowburn romance with her rival. Tell me... have you ever been in love?'",
      background: "https://i.pinimg.com/736x/28/11/b2/2811b250d9d13512a1c1e16157ee1c9f.jpg",
      choices: [
        { text: "Play Adrianne Lenker's 'Anything'", next: "lenker_path" },
        { text: "Ragebait him with a Kid Yugi song", next: "yugi_path" }
      ]
    },
    lenker_path: {
      text: "The salespea goes silent, mesmerized by the music. He unfurls a coily stemling and points silently toward the field encompassing the citadel. He looks bittersweet as you walk away. You walk until you meet Death in the field.",
      background: "https://i.pinimg.com/736x/c4/e9/3f/c4e93f27453842aa774a6c956200a01a.jpg",
      choices: [
        { text: "Ask him about a loved one who passed away", next: "death_loved_one" },
        { text: "Ask him about the meaning of life", next: "death_life" }
      ]
    },
    death_loved_one: {
      text: "Death looks at the horizon. 'They went where they wanted to go,' he says simply.",
      background: "https://i.pinimg.com/736x/40/9f/0b/409f0bb3b3f16be9d3e5b38db02daf1d.jpg",
      choices: [
        { text: "Ask about life instead", next: "death_life" },
        { text: "Say goodbye", next: "death_end" }
      ]
    },
    death_life: {
      text: "Death chuckles. 'Save yourself the painful explanation and go watch Adventure Time. They do it well. I liked how they imagined me.'",
      background: "https://i.pinimg.com/1200x/85/76/d4/8576d4ce1e52da0cb65b1052d7337700.jpg",
      choices: [
        { text: "Ask about your loved one instead", next: "death_loved_one" },
        { text: "Say goodbye", next: "death_end" }
      ]
    },
    death_end: {
      text: "The sun is setting. Death says, 'Well you seem like a decent fellow, walk straight for a while, you should find the Goddess of the End.' He disappears.",
      choices: [{ text: "Walk into the twilight", next: "goddess_end_sprout" }]
    },
    goddess_end_sprout: {
      text: "You rest by a sproutling as big as a tree. Drinking the dewdrop, you see a reflection of a light above. A treehouse! You climb up and knock on the door, realizing it's open.",
      background: "https://i.pinimg.com/1200x/9f/80/cb/9f80cbc77abdcc1041ad94159b439385.jpg",
      choices: [{ text: "Enter the house", next: "hamster_scene" }]
    },
    hamster_scene: {
      text: "A giant hamster the size of the house itself takes up every ounce of room. It lurches at you!",
      choices: [
        { text: "Pretend to be a baby hamster", next: "hamster_death" },
        { text: "Tell her your secret word", next: "goddess_end_reveal" }
      ]
    },
    hamster_death: {
      text: "The cycle of nature is cruel. She follows her instincts.",
      action: () => { setTimeout(() => { window.location.href = "https://www.reddit.com/r/biology/comments/4cwicq/why_did_my_hamster_eat_her_babies/?rdt=44346"; }, 2500); }
    },
    goddess_end_reveal: {
      text: () => `As you speak "${secretWord}", she turns into the Goddess of the End! She hugs you. 'Only the one who speaks the secret word could save me!' She explains her stress-tick turned her into a hamster, making her miss her appointment. She is worried about her girlfriend.`,
      background: "https://i.pinimg.com/736x/9b/20/99/9b20990526b734b93f1c741a1b1eed85.jpg",
      choices: [
        { text: "Give her the ring and tell her what happened", next: "ring_ending" },
        { text: "Comfort her", next: "kiss_ending" }
      ],
      renderHook: (scene) => {
        if (sessionStorage.getItem('hasRing') !== 'true') {
          scene.choices = scene.choices.filter(c => c.text !== "Give her the ring and tell her what happened");
        }
      }
    },
    ring_ending: {
      text: "You hand her the diamond ring. Her eyes fill with light. 'Oh thank you!' She kisses your forehead and you drift home.",
      action: () => { setTimeout(() => { window.location.href = "index.html"; }, 3000); }
    },
    kiss_ending: {
      text: "You comfort her. She kisses your forehead and you return to the sanctuary.",
      action: () => { setTimeout(() => { window.location.href = "index.html"; }, 3000); }
    },

    yugi_path: {
      text: "The salespea explodes with anger! A pea to the chest makes you black out.",
      choices: [{ text: "Wake up and look around", next: "lake_party" }]
    },
    lake_party: {
      text: "You wake up to find yourself in the cove of an estuary. The sea animals are having a raging party! A dolphin swims over. 'Yo, new guy! Wanna huff some puffer? It's the good stuff.'",
      background: "https://i.pinimg.com/736x/82/c9/8f/82c98fb149d724563f02e90c3489c238.jpg",
      choices: [
        { text: "Huff the puffer", next: "puffer_death" },
        { text: "No thanks, I'm good", next: "sturgeon_meet" }
      ]
    },
    puffer_death: {
      text: "You take a hit and die instantly. 'SICK PRANK DUDE' are the last words you hear as your consciousness fades away!",
      action: () => { setTimeout(() => { window.location.href = "https://youtu.be/msx3BAhIeQg?si=iADRvnoUdN5XTowY"; }, 2500); }
    },
    sturgeon_meet: {
      text: "The dolphin leaves. You talk to a chill 100-year-old sturgeon. It's her party. When everyone leaves and she starts to call it quits for the night she tells you one last thing. 'Be careful out there, kid. Whatever you do... don't tell the spider the secret word. You look around bleary eyed.. what should you do?'",
      choices: [
        { text: "Stay by the estuary until morning", next: "sturgeon_morning" },
        { text: "Try to leave the forest asap", next: "forest_muntjac_death" }
      ]
    },
    forest_muntjac_death: {
      text: "You trip over a baby muntjac. Its rhino friend charges.",
      background: "https://i.pinimg.com/736x/2a/7e/7d/2a7e7d1f8725fc233630c970b2e5b1a4.jpg",
      action: () => { setTimeout(() => { window.location.href = "https://youtu.be/jNNm8fTzxOw?si=w1UnCT96pEmCyqzs"; }, 2500); }
    },
    sturgeon_morning: {
      text: "You wake up to a sunny morning, well rested. A puppy-sized nudibranch starts cuddling you.",
      background: "https://i.pinimg.com/1200x/a7/fb/37/a7fb377817e06ba0b19e4c1dd6d51748.jpg",
      choices: [
        { text: "Pet it", next: "prince_zeth_meet" },
        { text: "Scream and push it away", next: "nudibranch_death" }
      ]
    },
    nudibranch_death: {
      text: "You fall onto a Portuguese Man o' War.",
      action: () => { setTimeout(() => { window.location.href = "https://youtu.be/aIovmgzyuL0?si=1S7plgHHDUy4skZ_"; }, 2500); }
    },
    prince_zeth_meet: {
      text: "A giant half whale merman, emerges from the water. 'He seems to like you' he says. 'I'm Prince Zeth, 26th to the throne. My nudibranch wants me to take you to the kelp forest....'",
      background: "https://i.pinimg.com/1200x/47/0f/05/470f05545f33786031a765035dc88b76.jpg",
      choices: [{ text: "Follow to the Kelp Forest", next: "kelp_forest" }]
    },
    kelp_forest: {
      text: "The forest of seaweed swayes gently under the water. You swim all the way down following the prince and his pet. On the seabed, inside a fish skeleton, a diamond ring glimmers.",
      background: "https://i.pinimg.com/736x/ac/e3/e0/ace3e01a0f3e54985af209335797e517.jpg",
      choices: [
        { text: "Offer it to the nudibranch", next: "give_ring" },
        { text: "Slip it on", next: "ring_death" }
      ]
    },
    ring_death: {
      text: "'Only SHE wears the ring.'",
      action: () => { setTimeout(() => { window.location.href = "index.html"; }, 2500); }
    },
    give_ring: {
      text: "Prince Zeth says 'No you can keep it. It has a purpose. Careful not to wear it though.'. He looks up and parts his lips as if to sing. A whale song sends you home.",
      action: () => { 
        sessionStorage.setItem('hasRing', 'true'); 
        setTimeout(() => { window.location.href = "index.html"; }, 3000); 
      }
    },

    pod_search: {
      text: "You climb into the glowing pod. Itâ€™s surprisingly cozy. You fall into a deep, velvety sleep.",
      background: "https://i.pinimg.com/1200x/c6/c0/06/c6c006dd946faaf1fdd1a8be0f96c5d3.jpg",
      choices: [ { text: "Wake up...", next: "butterfly_scene" } ]
    },
    butterfly_scene: {
      text: "You wake up as a butterfly! You fly higher untilâ€”snap. You find yourself snagged in fibres, thin and silklike but incredibly overwhelming.",
      background: "https://i.pinimg.com/1200x/c8/1b/95/c81b95660d2174852100813f70cfa29a.jpg",
      choices: [{ text: "Look at the web", next: "spider_web" }]
    },
    spider_web: {
      text: "A beautiful spider waltzes up in a thick Greek accent. 'Tell me the secret word and I might let you live.'",
      choices: [
        { text: "Give her your word", next: "spider_betrayal" },
        { text: "Refuse", next: "spider_refuse" },
        { text: "Did you build this whole web yourself?", next: "spider_convo" }
      ]
    },
    spider_betrayal: {
      text: "'So eager', she says with a smirk. You are eaten",
      action: () => { setTimeout(() => { window.location.href = "https://www.euronews.com/green/2025/11/07/worlds-biggest-spiderweb-home-to-more-than-110000-spiders-discovered-on-the-albanian-greek"; }, 2500); }
    },
    spider_refuse: {
      text: () => `She whispers: "${secretWord}." She knew it. You are eaten.`,
      action: () => { setTimeout(() => { window.location.href = "https://www.euronews.com/green/2025/11/07/worlds-biggest-spiderweb-home-to-more-than-110000-spiders-discovered-on-the-albanian-greek"; }, 2500); }
    },
    spider_convo: {
      text: "She looks taken aback. 'Yes...we were a dynasty of architects of Greco-Albanian descent. We built this shrine to the mother together... until one day they all disappeared. Leaving me alone to worship their memories.' She lets you fall.",
      choices: [{ text: "Fall toward the mushroom", next: "cat_scene" }]
    },
    cat_scene: {
      text: "You wake up human. A Bengal cat languishes on a toadstool mushroom. You ask it where you are and where you should go. 'Where do you want to be?', it replies. 'I don't know' you admit. 'Well then it doesn't matter does it'. The cat starts to leave but you beg for help. 'Ugh... okay but only if you know the answer to this: what is four times five?'",
      background: "https://i.pinimg.com/1200x/19/05/a8/1905a8798527ed9d2382031025c4ce76.jpg",
      choices: [{ text: "Answer the cat", input: true, buttonText: "Answer", onAction: () => {
        const ans = document.getElementById('player-input').value;
        if(ans == "12") renderScene('witch_house');
        else renderScene('starvation_death');
      }}]
    },
    starvation_death: {
      text: "The cat leaves you. You spend forever wandering the woods, and die.",
      action: () => { setTimeout(() => { window.location.href = "https://www.magellantv.com/articles/alice-in-wonderlands-hidden-satire-math-slips-down-the-rabbit-hole"; }, 2500); }
    },
    witch_house: {
      text: "The cat takes you to what looks like a witches cottage. From inside you hear a loud voice, 'I went all the way just to have it eaten by a damn blue rockfish! And now she won't even write me back!'",
      background: "https://i.pinimg.com/736x/5b/4f/f9/5b4ff95f2c8806c4a3d64dd5d007fbe1.jpg",
      choices: [
        { text: "Ask who her girlfriend is", next: "witch_death" },
        { text: "Reassure her", next: "witch_box" }
      ]
    },
    witch_death: {
      text: "Some things are personal! She zaps you.",
      background: "https://i.pinimg.com/1200x/eb/a3/1f/eba31fd2677b665578e52f8bb52a1abe.jpg",
      action: () => { setTimeout(() => { window.location.href = "https://www.nhm.ac.uk/wpy/gallery/2024-underwater-sanctuary"; }, 2500); }
    },
    witch_box: {
      text: "'Yeah you're right i'm sure she'll write back soon. Here take this' She gives you a box to go home.",
      background: "https://i.pinimg.com/1200x/0d/ed/96/0ded9630a30c65b126075413c4928119.jpg",
      action: () => { setTimeout(() => { window.location.href = "index.html"; }, 3000); }
    }
  };

  function renderScene(sceneKey) {
    const scene = scenes[sceneKey];
    const storyEl = document.getElementById('story-text');
    const choicesEl = document.getElementById('choices');
    const inputArea = document.getElementById('input-area');
    const body = document.getElementById('game-body');

    if (scene.background) body.style.backgroundImage = `url('${scene.background}')`;
    if (scene.renderHook) scene.renderHook(scene);
    if (scene.action) scene.action();

    storyEl.innerText = (typeof scene.text === "function") ? scene.text() : scene.text;

    choicesEl.innerHTML = "";
    if (scene.input) {
      inputArea.classList.remove('hidden');
      const submitBtn = document.createElement('button');
      submitBtn.className = 'choice-btn';
      submitBtn.innerText = scene.buttonText;
      submitBtn.onclick = scene.onAction;
      choicesEl.appendChild(submitBtn);
    } else {
      inputArea.classList.add('hidden');
      document.getElementById('player-input').value = "";
    }

    if (scene.choices) {
      scene.choices.forEach(choice => {
        const btn = document.createElement('button');
        btn.className = 'choice-btn';
        btn.innerText = choice.text;
        btn.onclick = () => renderScene(choice.next);
        choicesEl.appendChild(btn);
      });
    }
  }

  function toggleMute() {
    const audio = document.getElementById('myAudio');
    const btn = document.getElementById('mute-btn');
    if (audio.paused) { audio.play(); btn.innerText = "ðŸ”Š"; }
    else { audio.pause(); btn.innerText = "ðŸ”ˆ"; }
  }

  renderScene('password_check');
</script>
</body>
</html>
